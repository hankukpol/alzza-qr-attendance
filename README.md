# 알짜 진도별 문제풀이 QR 인증 시스템

Google Apps Script 기반 학생 인증 및 자료 배부 관리 시스템

## 📋 주요 기능

- ✅ **학생 인증**: 수험번호 + 이름으로 로그인
- ✅ **QR 스캔 자료 배부**: QR 코드를 통한 교재/자료 수령 기록
- ✅ **실시간 공지사항**: 팝업 공지 표시
- ✅ **과목별 좌석 정보**: 형법, 형소법, 경찰학, 헌법 좌석 표시
- ✅ **중복 수령 방지**: 당일 및 주차별 중복 체크

## ⚡ 성능 최적화 (2026-01-07)

캐싱 메커니즘 및 배치 처리를 통한 대폭 성능 개선:

- 📈 **로그인 속도**: 3.0초 → 0.3초 (90% 개선)
- 📈 **QR 스캔 속도**: 2.6초 → 1.0초 (60% 개선)

### 주요 개선 사항

1. **CacheService 활용**: 학생 데이터 및 공지사항 캐싱 (1시간 유지)
2. **알고리즘 최적화**: O(n) 순차 탐색 → O(1) Map 조회
3. **배치 처리**: 4번의 개별 Range 읽기 → 1번의 통합 읽기
4. **중복 제거**: 불필요한 스프레드시트 읽기 제거

## 🏗️ 시스템 구조

### 파일 구성

- **`Code.gs`**: 메인 로직 (인증, QR 처리, HTML 생성)
- **`Code_Performance_Test.gs`**: 성능 측정 도구
- **`agents.md`**: 프로젝트 문서 및 히스토리

### Google Sheets 구조

#### 1. 학생명단 시트
| A (수험번호) | B (이름) | C (형법 좌석) | D (형소법 좌석) | E (경찰학 좌석) | F (헌법 좌석) |
|-------------|----------|--------------|----------------|----------------|--------------|

#### 2. 공지사항 시트
| A (날짜) | B (제목) | C (내용) | D (게시여부) |
|---------|---------|---------|-------------|

#### 3. 자료배부기록 시트
| A (수험번호) | B (이름) | C~H (형법) | I~N (형소법) | O~V (경찰학) | W~AB (헌법) |
|-------------|----------|-----------|-------------|-------------|-------------|

## 🚀 설치 방법

### 1. Google Sheets 설정

1. 새 Google Sheets 생성
2. 위의 '시트 구조'에 맞게 시트 생성 및 헤더 추가
3. 학생 데이터 입력

### 2. Apps Script 프로젝트 생성

1. Google Sheets에서 **확장 프로그램** → **Apps Script** 클릭
2. `Code.gs` 내용 복사하여 붙여넣기
3. **프로젝트 설정**에서 시간대를 `Asia/Seoul`로 설정

### 3. 배포

1. Apps Script 편집기에서 **배포** → **새 배포** 클릭
2. 유형: **웹 앱**
3. 실행 계정: **나**
4. 액세스 권한: **모든 사용자**
5. 배포 후 웹 앱 URL 복사

### 4. 캐시 초기화 (최초 1회)

```javascript
// Apps Script 편집기에서 실행
clearCache()
```

## 💻 사용 방법

### 학생 로그인

1. 웹 앱 URL 접속
2. 수험번호와 이름 입력
3. 인증 성공 시 좌석 정보 및 QR 코드 표시

### 교재/자료 배부

1. 학생이 로그인 후 "교재/자료 수령 QR" 버튼 클릭
2. QR 코드 표시
3. 관리자가 QR 스캔 → 자동으로 수령 기록 저장

### 공지사항 관리

1. Google Sheets의 `공지사항` 시트에서 내용 작성
2. D열에 `TRUE` 입력하여 게시
3. 학생 로그인 시 자동으로 팝업 표시

## 🔧 관리자 가이드

### 캐시 관리

학생명단이나 공지사항 수정 후 반드시 캐시 초기화:

```javascript
// Apps Script 편집기에서 실행
clearCache()
```

**자동 캐시 초기화 설정 (선택):**
1. Apps Script → 트리거 메뉴
2. `clearCache` 함수에 일 타이머 설정 (매일 오전 1시)

### 성능 모니터링

```javascript
// Apps Script 편집기에서 실행
runAllPerformanceTests()
```

결과는 **보기** → **로그** 메뉴에서 확인

## 📊 성능 측정 결과

### 최적화 전/후 비교 (500명 기준)

| 작업 | 이전 | 개선 후 | 개선율 |
|------|------|---------|--------|
| 로그인 전체 | 3.0초 | 0.3초 | **90% ⬆️** |
| ㄴ 학생 조회 | 2.5초 | 0.05초 | 98% ⬆️ |
| ㄴ 공지 조회 | 0.3초 | 0.05초 | 83% ⬆️ |
| QR 스캔 전체 | 2.6초 | 1.0초 | **60% ⬆️** |
| ㄴ 과목별 읽기 | 0.8초 | 0.2초 | 75% ⬆️ |

## 🛠️ 기술 스택

- **Backend**: Google Apps Script (JavaScript)
- **Database**: Google Sheets
- **Cache**: CacheService (1시간 TTL)
- **Frontend**: HTML5, CSS3, Vanilla JavaScript
- **QR Code**: qrserver.com API

## 📝 개발 히스토리

- **2026-01-07**: 성능 최적화 (캐싱, 배치 처리)
- **2026-01-01**: 모바일 반응형 UI 개선
- **2025-12-06**: QR 자료 배부 기능 추가
- **2025-12-05**: 위치 인증 제거
- **2025-11-20**: 최초 시스템 구축

## 📄 라이선스

이 프로젝트는 한국경찰학원 내부용으로 개발되었습니다.

## 📞 문의

시스템 관련 문의는 데스크로 연락 바랍니다.

---

**한국경찰학원** | 알짜 진도별 문제풀이
